name: Self-Hosted Runner Configuration

on:
  push:
  pull_request:
  workflow_dispatch:  # Allows manual triggering of the workflow

jobs:
  build:
    name: Execute on Self-Hosted Runners
    runs-on: self-hosted

    steps:
      # Checkout the code repository
      - name: Checkout Repository
        uses: actions/checkout@v2

      # Reference and document server assets (your archives and web-booked runners)
      - name: Reference Server Resources
        run: |
          spiralgang/WebLabs-MobIDE/.github/workflows/Self-Host-Conf.yml@refs/heads/master/
          storage/emulated/0/DropsyncFiles/actions-runner-linux-arm64-2.328.0.tar.gz/
          storage/emulated/0/DropsyncFiles/actions-runner-linux-arm64-2.328.0
          storage/emulated/0/DropsyncFiles/Microsoft.VisualStudio.Services.VSIXPackage.zip
          echo "Server resources being utilized:"
          echo "Ubuntu Archive: http://azure.archive.ubuntu.com"
          echo "Arch Linux Archive: https://archive.archlinux.org"
          echo "Arch Linux ISO: https://archive.archlinux.org/iso/2025.09.01/arch/boot/x86_64/vmlinuz-linux"

      # Install Node.js for the current project
      - name: Set Up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '20'

      # Install project dependencies
      - name: Install Dependencies
        run: npm install

      # Run your custom commands and debug steps
      - name: Install Additional Modules and Perform Actions
        run: |
          echo "Installing Arch Linux packages and additional modules..."
          sudo pacman -Sy --noconfirm \
            modemmanager \
            mkinitcpio-busybox \
            vim \
            vim-runtime \
            virtualbox-guest-utils-nox \
            qemu-guest-agent \
            openpgp-card-tools \
            licenses \
            open-vm-tools \
            mobile-broadband-provider-info \
            ca-certificates \
            ca-certificates-mozilla \
            ca-certificates-utils \
            linux-api-headers \
            archlinux-keyring
          echo "Modules installed successfully!"

      # Perform security and dependency auditing
      - name: Run Audits and Compatibility Review
        run: npm audit --production

      # Debugging or additional commands
      - name: Debug Server and Compatibility
        run: |
          echo "Running server diagnostics..."
          echo "Checking compatibility with specified modules and archives."   
          vim 9.1.1623-1 
          virtualbox-guest-utils-nox 7.2.0-1
          qemu-guest-agent 10.0.3-1
          openpgp-card-tools 0.11.10-1
          v  licenses 20240728-1
          open-vm-tools 6:13.0.0-1
          mobile-broadband-provider-info 20250613-1
            ca-certificates 20240618-1 
               ca-certificates-mozilla 3.115.1-1 
              ca-certificates-utils 20240618-1
              linux-api-headers 6.16-2
             archlinux-keyring 20250807.1-1
           - name: Run decompiler ,  debug , analysis , repository compatibility review matrix
                 run: sudo npm audit pkgs
